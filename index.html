<html>
<head>
<link href="styles/interface.css" rel="stylesheet" type="text/css" />
<link href="styles/inventory.css" rel="stylesheet" type="text/css" />
<link href="styles/spellbook.css" rel="stylesheet" type="text/css" />
<link href="styles/shop.css" rel="stylesheet" type="text/css" />
<link href="styles/jquery-ui.min.css" rel="stylesheet" type="text/css" />
<link href="styles/preloader.css" rel="stylesheet" type="text/css" />

<script src="js/jquery-2.1.4.min.js" language="javascript" type="text/javascript"></script>
<script src="js/jquery-ui.min.js" language="javascript" type="text/javascript"></script>
<script src="js/jstorage.js" language="javascript" type="text/javascript"></script>

<script src="js/const.js" language="javascript" type="text/javascript"></script>
<script src="js/preloader.js" language="javascript" type="text/javascript"></script>
<script src="js/gamevars.js" language="javascript" type="text/javascript"></script>
<script src="js/monsters.js" language="javascript" type="text/javascript"></script>
<script src="js/items.js" language="javascript" type="text/javascript"></script>
<script src="js/hero.js" language="javascript" type="text/javascript"></script>
<script src="js/atlas.js" language="javascript" type="text/javascript"></script>
<script src="js/navigator.js" language="javascript" type="text/javascript"></script>
<script src="js/input.js" language="javascript" type="text/javascript"></script>
<script src="js/console.js" language="javascript" type="text/javascript"></script>
<script src="js/combat.js" language="javascript" type="text/javascript"></script>
<script src="js/party.js" language="javascript" type="text/javascript"></script>
<script src="js/placeofpower.js" language="javascript" type="text/javascript"></script>
<script src="js/inventory.js" language="javascript" type="text/javascript"></script>
<script src="js/spells.js" language="javascript" type="text/javascript"></script>
<script src="js/spellbook.js" language="javascript" type="text/javascript"></script>
<script src="js/saveload.js" language="javascript" type="text/javascript"></script>
<script src="js/shops.js" language="javascript" type="text/javascript"></script>
</head>
<body>
<div id="continue">
<div>A writ of fate was discovered.</div><br />
<button id="continueGame">(C)ontinue</button><br /><button id="newGame">(N)ew</button>
</div>
<div class="interface">
	<div id="goldPanel" title="Gold" class="floatPanel">0</div>
	<div id="essencePanel" title="Essence" class="floatPanel">0</div>
	<div id="compass" class="floatPanel"></div>
	<canvas id="view"></canvas>
	<div id="combatView">
		<div id="monsterList"></div>
	</div>

	<div id="partyInventory">
		<div id="invCurrHero">
			<span id="invHeroName">&nbsp;</span>
			<label id="trashItem" title="Drop items here to discard them permanently." data-isTrash="1"></label>
			<label id="heroMelee" title="Melee Weapon" data-equipSlot="1"></label>
			<label id="heroShield" title="Shield" data-equipSlot="4"></label>
			<label id="heroArmor" title="Armor" data-equipSlot="2"></label>
			<label id="heroAccessory" title="Accessory" data-equipSlot="3"></label>
		</div>
		<div id="invItems">
			<label data-pos="0"></label>
			<label data-pos="1"></label>
			<label data-pos="2"></label>
			<label data-pos="3"></label>
			<label data-pos="4"></label>
			<label data-pos="5"></label>
			<label data-pos="6"></label>
			<label data-pos="7"></label>
			<label data-pos="8"></label>
			<label data-pos="9"></label>
			<label data-pos="10"></label>
			<label data-pos="11"></label>
			<label data-pos="12"></label>
			<label data-pos="13"></label>
			<label data-pos="14"></label>
			<label data-pos="15"></label>
			<label data-pos="16"></label>
			<label data-pos="17"></label>
			<label data-pos="18"></label>
			<label data-pos="19"></label>
			<label data-pos="20"></label>
			<label data-pos="21"></label>
			<label data-pos="22"></label>
			<label data-pos="23"></label>
			<label data-pos="24"></label>
			<label data-pos="25"></label>
			<label data-pos="26"></label>
			<label data-pos="27"></label>
			<label data-pos="28"></label>
			<label data-pos="29"></label>
			<label data-pos="30"></label>
			<label data-pos="31"></label>
			<label data-pos="32"></label>
			<label data-pos="33"></label>
			<label data-pos="34"></label>
			<label data-pos="35"></label>
			<label data-pos="36"></label>
			<label data-pos="37"></label>
			<label data-pos="38"></label>
			<label data-pos="39"></label>
			<label data-pos="40"></label>
			<label data-pos="41"></label>
			<label data-pos="42"></label>
			<label data-pos="43"></label>
			<label data-pos="44"></label>
		</div>
	</div>
	
	<div id="char1" class="charPanel">
		<div id="selector"></div>
		<div class="life meter" id="life1">20/20</div>
		<div class="mana meter" id="mana1"></div>
	</div>
	<div id="char2" class="charPanel">
		<div class="life meter" id="life2"></div>
		<div class="mana meter" id="mana2"></div>
	</div>
	<div id="char3" class="charPanel">
		<div class="life meter" id="life3"></div>
		<div class="mana meter" id="mana3"></div>
	</div>
	<div id="char4" class="charPanel">
		<div class="life meter" id="life4"></div>
		<div class="mana meter" id="mana4"></div>
	</div>
	<div id="sys1" class="systemPanel">
		<div class="uibutton" id="inventory" title="Inventory"></div>
		<div class="uibutton" id="spellbook" title="Cast Spell"></div>
	</div>
	<div id="sys2" class="systemPanel">
		<div class="uibutton" id="map" title="Map"></div>
		<div class="uibutton" id="config" title="Options"></div>
		</div>
	<div id="commandPanel">
		<div></div>
		<div id="log"></div>
	</div>
	<div id="shopPanel">
		<div class="message">
			<div>&nbsp;&nbsp;Here's what I've got for sale. You can hover over an item to learn more about it or you can click on an item to purchase it.<br />
			 &nbsp;&nbsp;To sell something to me, just drag it onto my inventory and drop it. I'll be sure to pay you a <i>fair</i> price.</div>
			<a>Close (Escape)</a>
		</div>
		<div class="transactionLog">
			<div></div>
		</div>
		<div class="items">
			<label data-pos="0"></label>
			<label data-pos="1"></label>
			<label data-pos="2"></label>
			<label data-pos="3"></label>
			<label data-pos="4"></label>
			<label data-pos="5"></label>
			<label data-pos="6"></label>
			<label data-pos="7"></label>
			<label data-pos="8"></label>
			<label data-pos="9"></label>
			<label data-pos="10"></label>
			<label data-pos="11"></label>
			<label data-pos="12"></label>
			<label data-pos="13"></label>
			<label data-pos="14"></label>
			<label data-pos="15"></label>
			<label data-pos="16"></label>
			<label data-pos="17"></label>
			<label data-pos="18"></label>
			<label data-pos="19"></label>
			<label data-pos="20"></label>
			<span></span>
		</div>
	</div>
	<div id="spellPanel">
		<span id="spellTargeting"></span>
		<span id="spellPanelHeroName">Serena's Spellbook</span>
		<div>
			<label data-pos="0"></label>
			<label data-pos="1"></label>
			<label data-pos="2"></label>
			<label data-pos="3"></label>
			<label data-pos="4"></label>
			<label data-pos="5"></label>
			<label data-pos="6"></label>
			<label data-pos="7"></label>
			<label data-pos="8"></label>
			<label data-pos="9"></label>
			<label data-pos="10"></label>
			<label data-pos="11"></label>
			<label data-pos="12"></label>
			<label data-pos="13"></label>
			<label data-pos="14"></label>
			<label data-pos="15"></label>
			<label data-pos="16"></label>
			<label data-pos="17"></label>
			<label data-pos="18"></label>
			<label data-pos="19"></label>
			<label data-pos="20"></label>
			<label data-pos="21"></label>
			<label data-pos="22"></label>
			<label data-pos="23"></label>
			<label data-pos="24"></label>
			<label data-pos="25"></label>
			<label data-pos="26"></label>
			<label data-pos="27"></label>
			<label data-pos="28"></label>
			<label data-pos="29"></label>
		</div>
	</div>
	<div id="levelUpPanel">
		<ol>
			<li><a id="levelChar1"></a></li>
			<li><a id="levelChar2"></a></li>
			<li><a id="levelChar3"></a></li>
			<li><a id="levelChar4"></a></li>
			<li><a id="levelNone">Done</a></li>
		</ol>
		<div id="levelUpHeroStats">
			<span id="levelUpHeroName"></span>
			
			<ul id="levelUpStats">
				<li id="levelUpMight" data-statId="0"><span></span><label title="Might is the measure of a hero's physical strength. It increases the damage dealt with heavier melee weapons.">Might</label><div class="levelUpDown">[<a class="levelUpMinus">-</a> | <a class="levelUpPlus">+</a>]</div></li>
				<li id="levelUpDexterity" data-statId="1"><span></span><label title="Dexterity is the measure of a hero's deftness of arms. It increases the damage dealt with light melee weapons.">Dexterity</label><div class="levelUpDown">[<a class="levelUpMinus">-</a> | <a class="levelUpPlus">+</a>]</div></li>
				<li id="levelUpToughness" data-statId="2"><span></span><label title="Toughness is the measure of a hero's physical fortitude. It increases a hero's life force and their resistances slightly.">Toughness</label><div class="levelUpDown">[<a class="levelUpMinus">-</a> | <a class="levelUpPlus">+</a>]</div></li>
				<li id="levelUpAccuracy" data-statId="3"><span></span><label title="Accuracy is the measure of a hero's hand-eye coordination. It increases a hero's chance to successfully strike an enemy with a melee attack.">Accuracy</label><div class="levelUpDown">[<a class="levelUpMinus">-</a> | <a class="levelUpPlus">+</a>]</div></li>
				<li id="levelUpSpeed" data-statId="4"><span></span><label title="Speed is the measure of a hero's alacrity. It determines a hero's order in combat, number of turns per round, ability to dodge attacks and aids in the party's ability to flee from combat encounters.">Speed</label><div class="levelUpDown">[<a class="levelUpMinus">-</a> | <a class="levelUpPlus">+</a>]</div></li>
				<li id="levelUpCognition" data-statId="5"><span></span><label title="Cognition is the measure of a hero's ability to obtain and remember information. It increases a hero's mana pool and slightly increases portent and spell effectiveness.">Cognition</label><div class="levelUpDown">[<a class="levelUpMinus">-</a> | <a class="levelUpPlus">+</a>]</div></li>
				<li id="levelUpPiety" data-statId="6"><span></span><label title="Piety is a measure of a hero's faith in their gods. It increases a hero's mana pool slightly, increases the effectiveness of portents, and increases resistances slightly.">Piety</label><div class="levelUpDown">[<a class="levelUpMinus">-</a> | <a class="levelUpPlus">+</a>]</div></li>
				<li id="levelUpIntellect" data-statId="7"><span></span><label title="Intellect is a measure of a hero's cleverness and ability to solve complex problems. It increases a hero's mana pool slightly, increases the effectiveness of spells, and increases resistances slightly.">Intellect</label><div class="levelUpDown">[<a class="levelUpMinus">-</a> | <a class="levelUpPlus">+</a>]</div></li>
			</ul>
			
			<a id="levelUpConfirm">Confirm (Space)</a>
			<a id="levelUpCancel">Cancel (Escape)</a>
			
			<div id="levelUpDerivedStats">
				<span id="levelUpLevel">Lv. <span></span></span>
				<span id="levelUpCost">Advancement Cost: <span></span></span>
				<ul id="levelUpDerivedStats1">
					<li id="levelUpLife" data-statId="8"><label title="Life is the measure of a hero's total physical reserves. When it reaches 0, the hero is knocked unconcious. When it reaches -20% of the maximum, the hero is killed.">Life</label><span></span></li>
					<li id="levelUpMana" data-statId="9"><label title="Mana is the measure of a hero's total magical reserves. It is spent to cast portents and spells.">Mana</label><span></span></li>
					<li id="levelUpMightDamageBonus" data-statId="10"><label title="Might damage bonus is the measure of the damage added to attacks made with heavy melee weapons.">Might Damage Bonus</label><span></span></li>
					<li id="levelUpDexterityDamageBonus" data-statId="11"><label title="Dexterity damage bonus is the measure of the damage added to attacks made with light melee weapons.">Dexterity Damage Bonus</label><span></span></li>
					<li id="levelUpDodge" data-statId="12"><label title="Dodge is the measure of a hero's ability to dodge incoming attacks.">Dodge</label><span></span></li>
					<li id="levelUpTurnsPerRound" data-statId="13"><label title="Turns per round is the number of actions a hero is allowed to make during one round of combat.">Turns Per Round</label><span></span></li>
					<li id="levelUpPortentDamageBonus" data-statId="14"><label title="Portent Damage Bonus is the bonus damage that is added when dealing damage with portents.">Portent Damage Bonus</label><span></span></li>
					<li id="levelUpSpellDamageBonus" data-statId="15"><label title="Spell Damage Bonus is the bonus damage that is added when dealing damage with spells.">Spell Damage Bonus</label><span></span></li>
				</ul>
				<ul id="levelUpDerivedStats2">
					<li id="levelUpResistPhysical" data-elemId="0"><label title="Physical Resist gives the chance of reducing incoming physical damage.">Physical Resistance</label><span></span></li>
					<li id="levelUpResistFire" data-elemId="1"><label title="Fire Resist gives the chance of reducing incoming fire damage.">Fire Resistance</label><span></span></li>
					<li id="levelUpResistWater" data-elemId="2"><label title="Water Resist gives the chance of reducing incoming water damage.">Water Resistance</label><span></span></li>
					<li id="levelUpResistEarth" data-elemId="3"><label title="Earth Resist gives the chance of reducing incoming earth damage.">Earth Resistance</label><span></span></li>
					<li id="levelUpResistAir" data-elemId="4"><label title="Air Resist gives the chance of reducing incoming air damage.">Air Resistance</label><span></span></li>
					<li id="levelUpResistBody" data-elemId="5"><label title="Body Resist gives the chance of reducing incoming body damage.">Body Resistance</label><span></span></li>
					<li id="levelUpResistMind" data-elemId="6"><label title="Mind Resist gives the chance of reducing incoming mind damage.">Mind Resistance</label><span></span></li>
					<li id="levelUpResistSpirit" data-elemId="7"><label title="Spirit Resist gives the chance of reducing incoming spirit damage.">Spirit Resistance</label><span></span></li>
				</ul>
			</div>
		</div>
	</div>
	<div id="gameOver">
		Game Over
	</div>
</div>
<div id="preload">
</div>
<script>
var NAV = null;

$(function() {
	$( document ).tooltip({
		track: true
	});
	
	NAV = new navigator();
	
	$('#continueGame').click(function () {
		$('#continue').hide();
		$('.interface').show();
		SAVELOADER.load();
		GAME_MODE = MODE_NAV;
	});
	$('#newGame').click(newGame);
	
	$progress = $('.progress-bar');
	$percent = $('.percentage');
	$stripes = $('.progress-stripes');
	$stripes.text('////////////////////////');
	
	queueItemsForPreload();
	queueSpellsForPreload();
	
	// Call function to load array of images
	preload(preloadImages);

	// Call function to animate stripes
	stripesAnimate(); 
});

function beginGame() {
	if(SAVELOADER.doesSaveExist()) {
		GAME_MODE = MODE_MAINMENU;
		
		$('#continue').show();
		$('.interface').hide();
	} else {
		$('#continue').hide();
		$('.interface').show();
		newGame();
	}
	
	$('.loaderHolder').hide();
}

function newGame() {
	$('#continue').hide();
	$('.interface').show();
	
	PARTY = new party({
		experience: 0,
		heroes: [
		new hero({
			num:1,
			name: 'Crag the Hack',
			gender: GENDERS_MALE,
			charClass: CLASS_KNIGHT,
			portrait: 'images/portraits/male_1.png',
			stats: [10,5,9,10,9,2,1,1]
		}),
		new hero({
			num:2,
			name: 'Serena',
			gender: GENDERS_FEMALE,
			charClass: CLASS_CLERIC,
			portrait: 'images/portraits/female_3.png',
			stats: [4,4,7,8,5,8,10,3],
			spells: [SPELL_MEND_MINOR_WOUNDS]
		}),
		new hero({
			num:3,
			name: 'Swifty Sarg',
			gender: GENDERS_MALE,
			charClass: CLASS_THIEF,
			portrait: 'images/portraits/male_5.png',
			stats: [5,10,7,10,11,3,2,2]
		}),
		new hero({
			num:4,
			name: 'Wizz Bane',
			gender: GENDERS_FEMALE,
			charClass: CLASS_SORCERER,
			portrait: 'images/portraits/female_2.png',
			stats: [2,3,6,8,8,8,3,10],
			spells: [SPELL_STATIC_JOLT]
		})]
	});
	
	for(var i = 0; i < PARTY.heroes.length; i++) {
		PARTY.heroes[i].equipItem(ITEMS[ITEM_CLUB]);
		PARTY.heroes[i].equipItem(ITEMS[ITEM_CLOTHES]);
	}

	NAV.setMap(atlas[MAP_SORPIGAL]);
	NAV.teleportParty(9, 4, 'W');
	GAME_MODE = MODE_NAV;
	
	showText('This is a place of power. Resting at it will restore you and record your deeds.[br][br]'
		+ 'Arrows/WASD - Move and turn the party[br]'
		+ 'Spacebar - Interact with objects[br]'
		+ '1-4 - Select a hero if the inventory, spellbook, place of power or shop is open.[br]'
		+ 'C - Open spellbook to cast a spell[br]'
		+ 'I - Open the party\'s inventory[br][br]'
		+ 'When presented with a series of choices, you can press the number corresponding to a choice or you can click on it.[br][br]'
		+ 'In combat, a letter in each choice will be in parentheses. This is the key on your keyboard you can press instead of clicking on that option. The A key will attack the first monster in the list. The C key will open the current hero\'s spellbook to cast a spell. The D key will have the current hero dodge incoming attacks for a round.[br]'
		+ '[br]Good luck.');
}
</script>
<div class="loaderHolder">
<div class="loader red">
	<div class="progress-bar"><div class="progress-stripes"></div><div class="percentage">0%</div></div>
</div>
<span id="loadedMessage" class="red">Preparing rites...</span>
</div>
</body>
</html>